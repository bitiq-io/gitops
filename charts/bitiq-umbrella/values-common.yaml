env: local
baseDomain: apps-crc.testing
appNamespace: bitiq-local
gitopsNamespace: openshift-gitops
pipelinesNamespace: openshift-pipelines

# Repo & revision for all child Applications
repoUrl: https://github.com/bitiq-io/gitops.git
targetRevision: main

# Image Updater defaults (platform filter)
imageUpdater:
  # Set to the node architecture of your cluster
  # Common values: linux/amd64 (default CRC on x86_64), linux/arm64 (Apple Silicon)
  platforms: linux/amd64
  # Optional: registry auth secret for tag discovery (format: "<ns>/<secret>" or just name in openshift-gitops)
  pullSecret: ""
  # Control whether Image Updater manages frontend image (toy-web) annotations
  # Defaults to true; can be disabled per-env via ApplicationSet params
  enableFrontend: true

# Sample app images (Image Updater watches these)
# Use Quay for easier public tag discovery in local e2e
sampleAppImages:
  backend: quay.io/paulcapestany/toy-service
  frontend: quay.io/paulcapestany/toy-web

ciPipelines:
  serviceAccountName: pipeline
  fsGroup: 1000660000
  eventListener:
    name: bitiq-listener
    githubSecretName: github-webhook-secret
    route: true
  pipelines:
    - name: bitiq-build-and-push
      gitUrl: https://github.com/PaulCapestany/toy-service.git
      gitRevision: main
      dockerfile: Dockerfile
      contextDir: .
      imageRegistry: quay.io
      imageNamespace: paulcapestany
      imageName: toy-service
      tlsVerify: "true"
      repoFullName: PaulCapestany/toy-service
      runTests: "true"
      testImage: registry.access.redhat.com/ubi9/go-toolset:1.20
      testScript: |
        go test ./...
    - name: bitiq-web-build-and-push
      gitUrl: https://github.com/PaulCapestany/toy-web.git
      gitRevision: main
      dockerfile: Dockerfile
      contextDir: .
      imageRegistry: quay.io
      imageNamespace: paulcapestany
      imageName: toy-web
      tlsVerify: "true"
      repoFullName: PaulCapestany/toy-web
      runTests: "true"
      testImage: quay.io/devfile/nodejs-developer:ubi8
      testScript: |
        npm ci
        npm test -- --watch=false
