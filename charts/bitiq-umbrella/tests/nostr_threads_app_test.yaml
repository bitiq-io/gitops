suite: Nostr Threads Application
templates:
  - templates/app-nostr-threads.yaml
values:
  - ../values-common.yaml
release:
  name: umbrella
  namespace: openshift-gitops
tests:
  - it: renders Application when enabled
    set:
      env: local
      nostrThreads:
        enabled: true
    asserts:
      - equal:
          path: kind
          value: Application
      - equal:
          path: metadata.name
          value: nostr-threads-local
      - equal:
          path: spec.source.path
          value: charts/nostr-threads
      - equal:
          path: metadata.annotations["argocd-image-updater.argoproj.io/image-list"]
          value: "nostr-threads=quay.io/paulcapestany/nostr_threads"
      - equal:
          path: metadata.annotations["argocd-image-updater.argoproj.io/nostr-threads.helm.image-name"]
          value: image.repository
      - equal:
          path: metadata.annotations["argocd-image-updater.argoproj.io/write-back-target"]
          value: helmvalues:/charts/nostr-threads/values-local.yaml
